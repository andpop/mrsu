**********************
PowerShell transcript start
Start time: 20251024153702
**********************
Transcript started, output file is log.txt
304_DB_Afonkin_DE
304_DB_Aksenov_RM
304_DB_Artemev_DA
304_DB_Dolya_OA
304_DB_Geraskin_RG
304_DB_Isakov_VV
304_DB_Kiselev_NS
304_DB_Kizhaev_RP
304_DB_Kochetov_VA
304_DB_Kurmakaev_RA
=====================================================
/home/andrey/labs/DB/304_DB_Kurmakaev_RA
Из github.com-mrsu:andpop-mrsu/304_DB_Kurmakaev_RA
Из github.com-mrsu:andpop-mrsu/304_DB_Kurmakaev_RA
 * branch            master     -> FETCH_HEAD
 * branch            master     -> FETCH_HEAD
Уже актуально.
fatal: внешний репозиторий student уже существует
fatal: внешний репозиторий student уже существует
Из https://github.com/th000mas/304_DB_Kurmakaev_RA
Из https://github.com/th000mas/304_DB_Kurmakaev_RA
 * [новая ветка]     Task03     -> student/Task03
 * [новая ветка]     Task03     -> student/Task03
Merge made by the 'recursive' strategy.
 Task03/db_init.sql | 33178 +++++++++++++++++++++++++++++++++++++++++++++++++++
 Task03/task3.bat   |    63 +
 2 files changed, 33241 insertions(+)
 create mode 100644 Task03/db_init.sql
 create mode 100755 Task03/task3.bat
--------------------------------------------------
Task:  /home/andrey/labs/DB/304_DB_Kurmakaev_RA/Task03
--------------------------------------------------
Check path: db_init.sql
--------------------------------------------------
Check path: task3.bat
#!/bin/bash
chcp 65001

sqlite3 movies_rating.db < db_init.sql

echo "1. Составить список фильмов, имеющих хотя бы одну оценку. Список фильмов отсортировать по году выпуска и по названиям. В списке оставить первые 10 фильмов."
echo --------------------------------------------------
sqlite3 movies_rating.db -box -echo "SELECT DISTINCT m.title, m.year FROM movies m JOIN ratings r ON m.id = r.movie_id WHERE r.rating > 0 ORDER BY m.year, m.title LIMIT 10;"
echo " "

echo "2. Вывести список всех пользователей, фамилии (не имена!) которых начинаются на букву 'A'. Полученный список отсортировать по дате регистрации. В списке оставить первых 5 пользователей."
echo --------------------------------------------------
sqlite3 movies_rating.db -box -echo "SELECT name, register_date FROM users WHERE substr(name, instr(name, ' ') + 1, 1) = 'A' ORDER BY register_date LIMIT 5;"
echo " "

echo "3. Написать запрос, возвращающий информацию о рейтингах в более читаемом формате: имя и фамилия эксперта, название фильма, год выпуска, оценка и дата оценки в формате ГГГГ-ММ-ДД. Отсортировать данные по имени эксперта, затем названию фильма и оценке. В списке оставить первые 50 записей."
echo --------------------------------------------------
sqlite3 movies_rating.db -box -echo "SELECT
    u.name AS expert_name,
    m.title AS movie_title,
    m.year AS release_year,
    r.rating AS score,
    DATE(datetime(r.timestamp, 'unixepoch')) AS rating_date
FROM ratings r
JOIN users u ON r.user_id = u.id
JOIN movies m ON r.movie_id = m.id
ORDER BY u.name, m.title, r.rating
LIMIT 50;"
echo " "

echo "4. Вывести список фильмов с указанием тегов, которые были им присвоены пользователями. Сортировать по году выпуска, затем по названию фильма, затем по тегу. В списке оставить первые 40 записей."
echo --------------------------------------------------
sqlite3 movies_rating.db -box -echo "SELECT m.title, t.tag FROM movies m JOIN tags t ON m.id = t.movie_id ORDER BY m.year, m.title, t.tag LIMIT 40;"
echo " "

echo "5. Вывести список самых свежих фильмов. В список должны войти все фильмы последнего года выпуска, имеющиеся в базе данных. Запрос должен быть универсальным, не зависящим от исходных данных (нужный год выпуска должен определяться в запросе, а не жестко задаваться)."
echo --------------------------------------------------
sqlite3 movies_rating.db -box -echo "SELECT title, year FROM movies WHERE year = (SELECT MAX(year) FROM movies);"
echo " "

echo "6. Найти все драмы, выпущенные после 2005 года, которые понравились женщинам (оценка не ниже 4.5). Для каждого фильма в этом списке вывести название, год выпуска и количество таких оценок. Результат отсортировать по году выпуска и названию фильма."
echo --------------------------------------------------
sqlite3 movies_rating.db -box -echo "SELECT
    m.title,
    m.year,
    COUNT(r.rating) AS female_high_ratings
FROM movies m
JOIN ratings r ON m.id = r.movie_id
JOIN users u ON r.user_id = u.id
WHERE m.year > 2005
  AND m.genres LIKE '%Drama%'
  AND r.rating >= 4.5
  AND u.gender = 'female'
GROUP BY m.id, m.title, m.year
ORDER BY m.year, m.title;"
echo " "

echo "7. Провести анализ востребованности ресурса - вывести количество пользователей, регистрировавшихся на сайте в каждом году. Найти, в каких годах регистрировалось больше всего и меньше всего пользователей."
echo --------------------------------------------------
sqlite3 movies_rating.db -box -echo "SELECT strftime('%Y', datetime(register_date, 'unixepoch')) AS reg_year, COUNT(*) AS user_count FROM users GROUP BY reg_year ORDER BY reg_year;"
sqlite3 movies_rating.db -box -echo "SELECT strftime('%Y', datetime(register_date, 'unixepoch')) AS reg_year, COUNT(*) AS user_count FROM users GROUP BY reg_year ORDER BY user_count DESC LIMIT 1;"
sqlite3 movies_rating.db -box -echo "SELECT strftime('%Y', datetime(register_date, 'unixepoch')) AS reg_year, COUNT(*) AS user_count FROM users GROUP BY reg_year ORDER BY user_count ASC LIMIT 1;"
echo " "
--------------------------------------------------
Run: ./task3.bat
1. Составить список фильмов, имеющих хотя бы одну оценку. Список фильмов отсортировать по году выпуска и по названиям. В списке оставить первые 10 фильмов.
--------------------------------------------------
SELECT DISTINCT m.title, m.year FROM movies m JOIN ratings r ON m.id = r.movie_id WHERE r.rating > 0 ORDER BY m.year, m.title LIMIT 10;
┌─────────────────────────────────────────────────────┬──────┐
│                        title                        │ year │
├─────────────────────────────────────────────────────┼──────┤
│ Black Mirror                                        │      │
│ Death Note: Desu nôto (2006–2007)                   │      │
│ Generation Iron 2                                   │      │
│ Maria Bamford: Old Baby                             │      │
│ The Adventures of Sherlock Holmes and Doctor Watson │      │
│ Trip to the Moon, A (Voyage dans la lune, Le)       │ 1902 │
│ The Electric Hotel                                  │ 1908 │
│ 20,000 Leagues Under the Sea                        │ 1916 │
│ Rink, The                                           │ 1916 │
│ Immigrant, The                                      │ 1917 │
└─────────────────────────────────────────────────────┴──────┘
 
2. Вывести список всех пользователей, фамилии (не имена!) которых начинаются на букву 'A'. Полученный список отсортировать по дате регистрации. В списке оставить первых 5 пользователей.
--------------------------------------------------
SELECT name, register_date FROM users WHERE substr(name, instr(name, ' ') + 1, 1) = 'A' ORDER BY register_date LIMIT 5;
┌────────────────────┬───────────────┐
│        name        │ register_date │
├────────────────────┼───────────────┤
│ Callie Abshire     │ 2005-01-02    │
│ Jena Abernathy     │ 2006-06-10    │
│ Deron Altenwerth   │ 2007-05-16    │
│ Lilliana Abernathy │ 2007-10-25    │
│ Quinton Anderson   │ 2008-04-04    │
└────────────────────┴───────────────┘
 
3. Написать запрос, возвращающий информацию о рейтингах в более читаемом формате: имя и фамилия эксперта, название фильма, год выпуска, оценка и дата оценки в формате ГГГГ-ММ-ДД. Отсортировать данные по имени эксперта, затем названию фильма и оценке. В списке оставить первые 50 записей.
--------------------------------------------------
SELECT
    u.name AS expert_name,
    m.title AS movie_title,
    m.year AS release_year,
    r.rating AS score,
    DATE(datetime(r.timestamp, 'unixepoch')) AS rating_date
FROM ratings r
JOIN users u ON r.user_id = u.id
JOIN movies m ON r.movie_id = m.id
ORDER BY u.name, m.title, r.rating
LIMIT 50;
┌──────────────────┬────────────────────────────────────────────────────────────────────────────────┬──────────────┬───────┬─────────────┐
│   expert_name    │                                  movie_title                                   │ release_year │ score │ rating_date │
├──────────────────┼────────────────────────────────────────────────────────────────────────────────┼──────────────┼───────┼─────────────┤
│ Adell Gusikowski │ (500) Days of Summer                                                           │ 2009         │ 5.0   │ 2015-11-03  │
│ Adell Gusikowski │ 12 Angry Men                                                                   │ 1957         │ 4.5   │ 2015-11-15  │
│ Adell Gusikowski │ 12 Chairs                                                                      │ 1971         │ 4.5   │ 2015-11-06  │
│ Adell Gusikowski │ 12 Chairs                                                                      │ 1976         │ 5.0   │ 2018-05-13  │
│ Adell Gusikowski │ 12 Years a Slave                                                               │ 2013         │ 4.0   │ 2015-11-03  │
│ Adell Gusikowski │ 127 Hours                                                                      │ 2010         │ 4.0   │ 2015-11-03  │
│ Adell Gusikowski │ 13 Tzameti                                                                     │ 2005         │ 4.5   │ 2015-11-27  │
│ Adell Gusikowski │ 1408                                                                           │ 2007         │ 4.0   │ 2015-11-15  │
│ Adell Gusikowski │ 2 Fast 2 Furious (Fast and the Furious 2, The)                                 │ 2003         │ 3.0   │ 2015-11-05  │
│ Adell Gusikowski │ 2001: A Space Odyssey                                                          │ 1968         │ 4.0   │ 2015-11-22  │
│ Adell Gusikowski │ 21                                                                             │ 2008         │ 4.0   │ 2015-11-03  │
│ Adell Gusikowski │ 28 Days Later                                                                  │ 2002         │ 4.0   │ 2015-11-03  │
│ Adell Gusikowski │ 28 Weeks Later                                                                 │ 2007         │ 4.0   │ 2015-11-05  │
│ Adell Gusikowski │ 3 Idiots                                                                       │ 2009         │ 4.5   │ 2015-11-03  │
│ Adell Gusikowski │ 3-Iron (Bin-jip)                                                               │ 2004         │ 4.0   │ 2015-11-03  │
│ Adell Gusikowski │ 300                                                                            │ 2007         │ 4.5   │ 2015-11-03  │
│ Adell Gusikowski │ 3:10 to Yuma                                                                   │ 2007         │ 3.5   │ 2016-06-15  │
│ Adell Gusikowski │ 40 Days and 40 Nights                                                          │ 2002         │ 3.0   │ 2015-11-15  │
│ Adell Gusikowski │ 40-Year-Old Virgin, The                                                        │ 2005         │ 3.0   │ 2015-11-03  │
│ Adell Gusikowski │ 400 Blows, The (Les quatre cents coups)                                        │ 1959         │ 4.0   │ 2015-11-22  │
│ Adell Gusikowski │ 5 Centimeters per Second (Byôsoku 5 senchimêtoru)                              │ 2007         │ 4.5   │ 2015-11-03  │
│ Adell Gusikowski │ 50/50                                                                          │ 2011         │ 4.0   │ 2015-11-15  │
│ Adell Gusikowski │ 8 Mile                                                                         │ 2002         │ 3.5   │ 2015-11-05  │
│ Adell Gusikowski │ A Plasticine Crow                                                              │ 1981         │ 5.0   │ 2018-05-13  │
│ Adell Gusikowski │ About Time                                                                     │ 2013         │ 5.0   │ 2015-11-03  │
│ Adell Gusikowski │ Adjustment Bureau, The                                                         │ 2011         │ 3.5   │ 2015-11-15  │
│ Adell Gusikowski │ Adventures Of Sherlock Holmes And Dr. Watson: The Twentieth Century Approaches │ 1986         │ 5.0   │ 2018-05-13  │
│ Adell Gusikowski │ Adventures of Mowgli: The Kidnapping                                           │ 1968         │ 4.5   │ 2018-05-13  │
│ Adell Gusikowski │ Afonya                                                                         │ 1975         │ 4.0   │ 2015-11-15  │
│ Adell Gusikowski │ Aguirre: The Wrath of God (Aguirre, der Zorn Gottes)                           │ 1972         │ 3.5   │ 2015-11-03  │
│ Adell Gusikowski │ Akira                                                                          │ 1988         │ 3.5   │ 2015-11-22  │
│ Adell Gusikowski │ Alesha Popovich and Tugarin the Dragon                                         │ 2004         │ 5.0   │ 2018-05-13  │
│ Adell Gusikowski │ Alice in Wonderland                                                            │ 2010         │ 4.0   │ 2015-11-05  │
│ Adell Gusikowski │ Alien                                                                          │ 1979         │ 4.0   │ 2015-11-22  │
│ Adell Gusikowski │ All About Eve                                                                  │ 1950         │ 4.0   │ 2015-11-15  │
│ Adell Gusikowski │ Along Came Polly                                                               │ 2004         │ 3.5   │ 2015-11-06  │
│ Adell Gusikowski │ Amadeus                                                                        │ 1984         │ 5.0   │ 2015-11-22  │
│ Adell Gusikowski │ Amelie (Fabuleux destin d'Amélie Poulain, Le)                                  │ 2001         │ 4.0   │ 2015-11-03  │
│ Adell Gusikowski │ American Beauty                                                                │ 1999         │ 5.0   │ 2015-11-05  │
│ Adell Gusikowski │ American Gangster                                                              │ 2007         │ 3.5   │ 2015-11-03  │
│ Adell Gusikowski │ American History X                                                             │ 1998         │ 4.0   │ 2015-11-03  │
│ Adell Gusikowski │ American Pie 2                                                                 │ 2001         │ 3.5   │ 2015-11-03  │
│ Adell Gusikowski │ American Psycho                                                                │ 2000         │ 3.5   │ 2015-11-03  │
│ Adell Gusikowski │ American Wedding (American Pie 3)                                              │ 2003         │ 3.5   │ 2015-11-15  │
│ Adell Gusikowski │ Anchorman: The Legend of Ron Burgundy                                          │ 2004         │ 3.0   │ 2015-11-15  │
│ Adell Gusikowski │ Andrei Rublev (Andrey Rublyov)                                                 │ 1969         │ 4.5   │ 2015-11-04  │
│ Adell Gusikowski │ Angels & Demons                                                                │ 2009         │ 4.5   │ 2015-11-03  │
│ Adell Gusikowski │ Annie Hall                                                                     │ 1977         │ 4.0   │ 2015-11-15  │
│ Adell Gusikowski │ Antichrist                                                                     │ 2009         │ 5.0   │ 2015-11-27  │
│ Adell Gusikowski │ Apartment, The                                                                 │ 1960         │ 4.0   │ 2015-11-15  │
└──────────────────┴────────────────────────────────────────────────────────────────────────────────┴──────────────┴───────┴─────────────┘
 
4. Вывести список фильмов с указанием тегов, которые были им присвоены пользователями. Сортировать по году выпуска, затем по названию фильма, затем по тегу. В списке оставить первые 40 записей.
--------------------------------------------------
SELECT m.title, t.tag FROM movies m JOIN tags t ON m.id = t.movie_id ORDER BY m.year, m.title, t.tag LIMIT 40;
┌───────────────────────────────────────────────────────────┬───────────────────────┐
│                           title                           │          tag          │
├───────────────────────────────────────────────────────────┼───────────────────────┤
│ Paterson                                                  │ quirky                │
│ Paterson                                                  │ sweet                 │
│ Paterson                                                  │ understated           │
│ Kid, The                                                  │ orphans               │
│ Nosferatu (Nosferatu, eine Symphonie des Grauens)         │ vampires              │
│ Our Hospitality                                           │ In Netflix queue      │
│ Safety Last!                                              │ Clock                 │
│ Greed                                                     │ gold                  │
│ Gold Rush, The                                            │ mining                │
│ Faust                                                     │ In Netflix queue      │
│ College                                                   │ In Netflix queue      │
│ Circus, The                                               │ big top               │
│ Circus, The                                               │ circus                │
│ Passion of Joan of Arc, The (Passion de Jeanne d'Arc, La) │ saint                 │
│ Andalusian Dog, An (Chien andalou, Un)                    │ mindfuck              │
│ Andalusian Dog, An (Chien andalou, Un)                    │ surreal               │
│ Andalusian Dog, An (Chien andalou, Un)                    │ surrealism            │
│ Blue Angel, The (Blaue Engel, Der)                        │ nightclub             │
│ Blue Angel, The (Blaue Engel, Der)                        │ singers               │
│ Divorcee, The                                             │ divorce               │
│ City Lights                                               │ blind                 │
│ Frankenstein                                              │ In Netflix queue      │
│ M                                                         │ atmospheric           │
│ M                                                         │ chilly                │
│ M                                                         │ creepy                │
│ M                                                         │ menacing              │
│ M                                                         │ mental illness        │
│ M                                                         │ oninous               │
│ M                                                         │ serial killer         │
│ Maltese Falcon, The (a.k.a. Dangerous Female)             │ heist                 │
│ Farewell to Arms, A                                       │ Hemingway             │
│ Freaks                                                    │ circus                │
│ Horse Feathers                                            │ Marx brothers         │
│ Flying Down to Rio                                        │ Astaire and Rogers    │
│ Invisible Man, The                                        │ invisibility          │
│ Gay Divorcee, The                                         │ divorce               │
│ It Happened One Night                                     │ Screwball             │
│ Thin Man, The                                             │ Nick and Nora Charles │
│ Twentieth Century                                         │ In Netflix queue      │
│ 39 Steps, The                                             │ fugitive              │
└───────────────────────────────────────────────────────────┴───────────────────────┘
 
5. Вывести список самых свежих фильмов. В список должны войти все фильмы последнего года выпуска, имеющиеся в базе данных. Запрос должен быть универсальным, не зависящим от исходных данных (нужный год выпуска должен определяться в запросе, а не жестко задаваться).
--------------------------------------------------
SELECT title, year FROM movies WHERE year = (SELECT MAX(year) FROM movies);
┌────────────────────────────────────┬──────┐
│               title                │ year │
├────────────────────────────────────┼──────┤
│ Avengers: Infinity War - Part I    │ 2018 │
│ Annihilation                       │ 2018 │
│ The Commuter                       │ 2018 │
│ Insidious: The Last Key            │ 2018 │
│ Game Night                         │ 2018 │
│ Maze Runner: The Death Cure        │ 2018 │
│ Isle of Dogs                       │ 2018 │
│ The Clapper                        │ 2018 │
│ Tom Segura: Disgraceful            │ 2018 │
│ When We First Met                  │ 2018 │
│ The Cloverfield Paradox            │ 2018 │
│ Tomb Raider                        │ 2018 │
│ Fred Armisen: Standup for Drummers │ 2018 │
│ Death Wish                         │ 2018 │
│ A Wrinkle in Time                  │ 2018 │
│ Love, Simon                        │ 2018 │
│ A Quiet Place                      │ 2018 │
│ Alpha                              │ 2018 │
│ I Kill Giants                      │ 2018 │
│ Game Over, Man!                    │ 2018 │
│ Blockers                           │ 2018 │
│ Pacific Rim: Uprising              │ 2018 │
│ Rampage                            │ 2018 │
│ Jurassic World: Fallen Kingdom     │ 2018 │
│ Incredibles 2                      │ 2018 │
│ Deadpool 2                         │ 2018 │
│ Solo: A Star Wars Story            │ 2018 │
│ Won't You Be My Neighbor?          │ 2018 │
│ Sorry to Bother You                │ 2018 │
│ Ant-Man and the Wasp               │ 2018 │
│ Dogman                             │ 2018 │
│ Mamma Mia: Here We Go Again!       │ 2018 │
│ Tag                                │ 2018 │
│ The Man Who Killed Don Quixote     │ 2018 │
│ Boundaries                         │ 2018 │
│ Spiral                             │ 2018 │
│ Mission: Impossible - Fallout      │ 2018 │
│ SuperFly                           │ 2018 │
│ BlacKkKlansman                     │ 2018 │
│ The Darkest Minds                  │ 2018 │
│ Bungo Stray Dogs: Dead Apple       │ 2018 │
└────────────────────────────────────┴──────┘
 
6. Найти все драмы, выпущенные после 2005 года, которые понравились женщинам (оценка не ниже 4.5). Для каждого фильма в этом списке вывести название, год выпуска и количество таких оценок. Результат отсортировать по году выпуска и названию фильма.
--------------------------------------------------
SELECT
    m.title,
    m.year,
    COUNT(r.rating) AS female_high_ratings
FROM movies m
JOIN ratings r ON m.id = r.movie_id
JOIN users u ON r.user_id = u.id
WHERE m.year > 2005
  AND m.genres LIKE '%Drama%'
  AND r.rating >= 4.5
  AND u.gender = 'female'
GROUP BY m.id, m.title, m.year
ORDER BY m.year, m.title;
┌─────────────────────────────────────────────────────────────────┬──────┬─────────────────────┐
│                              title                              │ year │ female_high_ratings │
├─────────────────────────────────────────────────────────────────┼──────┼─────────────────────┤
│ Away from Her                                                   │ 2006 │ 1                   │
│ Babel                                                           │ 2006 │ 2                   │
│ Cashback                                                        │ 2006 │ 1                   │
│ Children of Men                                                 │ 2006 │ 3                   │
│ Departed, The                                                   │ 2006 │ 7                   │
│ Devil Wears Prada, The                                          │ 2006 │ 1                   │
│ Girl Who Leapt Through Time, The (Toki o kakeru shôjo)          │ 2006 │ 1                   │
│ I Served the King of England (Obsluhoval jsem anglického krále) │ 2006 │ 1                   │
│ Inside Man                                                      │ 2006 │ 1                   │
│ Jesus Camp                                                      │ 2006 │ 1                   │
│ Last Kiss, The                                                  │ 2006 │ 1                   │
│ Little Children                                                 │ 2006 │ 1                   │
│ Little Miss Sunshine                                            │ 2006 │ 2                   │
│ Lucky Number Slevin                                             │ 2006 │ 2                   │
│ My Love                                                         │ 2006 │ 1                   │
│ Pan's Labyrinth (Laberinto del fauno, El)                       │ 2006 │ 3                   │
│ Prestige, The                                                   │ 2006 │ 5                   │
│ Pursuit of Happyness, The                                       │ 2006 │ 3                   │
│ Smokin' Aces                                                    │ 2006 │ 1                   │
│ Thank You for Smoking                                           │ 2006 │ 2                   │
│ This Is England                                                 │ 2006 │ 1                   │
│ Three Burials of Melquiades Estrada, The                        │ 2006 │ 1                   │
│ 3:10 to Yuma                                                    │ 2007 │ 1                   │
│ 5 Centimeters per Second (Byôsoku 5 senchimêtoru)               │ 2007 │ 1                   │
│ American Gangster                                               │ 2007 │ 1                   │
│ Breach                                                          │ 2007 │ 1                   │
│ Control                                                         │ 2007 │ 1                   │
│ Dan in Real Life                                                │ 2007 │ 1                   │
│ Disturbia                                                       │ 2007 │ 1                   │
│ Eastern Promises                                                │ 2007 │ 3                   │
│ Fracture                                                        │ 2007 │ 1                   │
│ Gone Baby Gone                                                  │ 2007 │ 1                   │
│ Harry Potter and the Order of the Phoenix                       │ 2007 │ 1                   │
│ Into the Wild                                                   │ 2007 │ 4                   │
│ Knocked Up                                                      │ 2007 │ 1                   │
│ Like Stars on Earth (Taare Zameen Par)                          │ 2007 │ 1                   │
│ Michael Clayton                                                 │ 2007 │ 1                   │
│ Mr. Brooks                                                      │ 2007 │ 1                   │
│ No Country for Old Men                                          │ 2007 │ 2                   │
│ Persepolis                                                      │ 2007 │ 1                   │
│ Ratatouille                                                     │ 2007 │ 2                   │
│ There Will Be Blood                                             │ 2007 │ 3                   │
│ Waitress                                                        │ 2007 │ 1                   │
│ Zodiac                                                          │ 2007 │ 2                   │
│ Berlin Calling                                                  │ 2008 │ 1                   │
│ Dark Knight, The                                                │ 2008 │ 14                  │
│ Definitely, Maybe                                               │ 2008 │ 1                   │
│ Dr. Horrible's Sing-Along Blog                                  │ 2008 │ 1                   │
│ Front of the Class                                              │ 2008 │ 1                   │
│ Frost/Nixon                                                     │ 2008 │ 1                   │
│ Gran Torino                                                     │ 2008 │ 3                   │
│ Hunger                                                          │ 2008 │ 1                   │
│ Hurt Locker, The                                                │ 2008 │ 1                   │
│ In Bruges                                                       │ 2008 │ 1                   │
│ Ip Man                                                          │ 2008 │ 1                   │
│ Slumdog Millionaire                                             │ 2008 │ 2                   │
│ Stoning of Soraya M., The                                       │ 2008 │ 1                   │
│ Strictly Sexual                                                 │ 2008 │ 1                   │
│ Taken                                                           │ 2008 │ 1                   │
│ Twilight                                                        │ 2008 │ 2                   │
│ (500) Days of Summer                                            │ 2009 │ 1                   │
│ 3 Idiots                                                        │ 2009 │ 1                   │
│ Angels & Demons                                                 │ 2009 │ 1                   │
│ Antichrist                                                      │ 2009 │ 1                   │
│ Blind Side, The                                                 │ 2009 │ 2                   │
│ Boondock Saints II: All Saints Day, The                         │ 2009 │ 1                   │
│ Education, An                                                   │ 2009 │ 1                   │
│ Girl Who Played with Fire, The (Flickan som lekte med elden)    │ 2009 │ 1                   │
│ Girl with the Dragon Tattoo, The (Män som hatar kvinnor)        │ 2009 │ 3                   │
│ Imaginarium of Doctor Parnassus, The                            │ 2009 │ 1                   │
│ Inglourious Basterds                                            │ 2009 │ 5                   │
│ Mary and Max                                                    │ 2009 │ 1                   │
│ Moon                                                            │ 2009 │ 1                   │
│ Ninja Assassin                                                  │ 2009 │ 1                   │
│ Pirate Radio                                                    │ 2009 │ 1                   │
│ Ugly Truth, The                                                 │ 2009 │ 1                   │
│ Up                                                              │ 2009 │ 4                   │
│ Watchmen                                                        │ 2009 │ 1                   │
│ White Ribbon, The (Das weiße Band)                              │ 2009 │ 1                   │
│ Biutiful                                                        │ 2010 │ 1                   │
│ Black Swan                                                      │ 2010 │ 1                   │
│ Book of Eli, The                                                │ 2010 │ 1                   │
│ Fighter, The                                                    │ 2010 │ 1                   │
│ Four Lions                                                      │ 2010 │ 1                   │
│ Inception                                                       │ 2010 │ 11                  │
│ King's Speech, The                                              │ 2010 │ 3                   │
│ Next Three Days, The                                            │ 2010 │ 1                   │
│ Shutter Island                                                  │ 2010 │ 5                   │
│ Social Network, The                                             │ 2010 │ 1                   │
│ Temple Grandin                                                  │ 2010 │ 1                   │
│ The Pacific                                                     │ 2010 │ 1                   │
│ Best Exotic Marigold Hotel, The                                 │ 2011 │ 1                   │
│ Colombiana                                                      │ 2011 │ 1                   │
│ Crazy, Stupid, Love.                                            │ 2011 │ 1                   │
│ From Up on Poppy Hill (Kokuriko-zaka kara)                      │ 2011 │ 1                   │
│ Girl with the Dragon Tattoo, The                                │ 2011 │ 1                   │
│ Goon                                                            │ 2011 │ 1                   │
│ Harry Potter and the Deathly Hallows: Part 2                    │ 2011 │ 1                   │
│ Help, The                                                       │ 2011 │ 1                   │
│ Intouchables                                                    │ 2011 │ 3                   │
│ Lincoln Lawyer, The                                             │ 2011 │ 1                   │
│ Mechanic, The                                                   │ 2011 │ 1                   │
│ Melancholia                                                     │ 2011 │ 1                   │
│ Moneyball                                                       │ 2011 │ 1                   │
│ Rise of the Planet of the Apes                                  │ 2011 │ 1                   │
│ The Artist                                                      │ 2011 │ 1                   │
│ Thor                                                            │ 2011 │ 1                   │
│ Tinker Tailor Soldier Spy                                       │ 2011 │ 2                   │
│ Warrior                                                         │ 2011 │ 1                   │
│ Broken                                                          │ 2012 │ 1                   │
│ Django Unchained                                                │ 2012 │ 3                   │
│ Ernest & Célestine (Ernest et Célestine)                        │ 2012 │ 1                   │
│ Hunt, The (Jagten)                                              │ 2012 │ 1                   │
│ Impossible, The (Imposible, Lo)                                 │ 2012 │ 1                   │
│ Perks of Being a Wallflower, The                                │ 2012 │ 1                   │
│ Silver Linings Playbook                                         │ 2012 │ 1                   │
│ Taken 2                                                         │ 2012 │ 1                   │
│ The Hunger Games                                                │ 2012 │ 1                   │
│ Zero Dark Thirty                                                │ 2012 │ 1                   │
│ About Time                                                      │ 2013 │ 1                   │
│ Captain Phillips                                                │ 2013 │ 1                   │
│ Dallas Buyers Club                                              │ 2013 │ 1                   │
│ Filth                                                           │ 2013 │ 1                   │
│ Great Beauty, The (Grande Bellezza, La)                         │ 2013 │ 1                   │
│ Great Gatsby, The                                               │ 2013 │ 1                   │
│ Her                                                             │ 2013 │ 2                   │
│ Legend No. 17                                                   │ 2013 │ 1                   │
│ Nymphomaniac: Volume I                                          │ 2013 │ 1                   │
│ Nymphomaniac: Volume II                                         │ 2013 │ 1                   │
│ Prisoners                                                       │ 2013 │ 1                   │
│ Rush                                                            │ 2013 │ 1                   │
│ Secret Life of Walter Mitty, The                                │ 2013 │ 1                   │
│ Tangerines                                                      │ 2013 │ 1                   │
│ Wolf of Wall Street, The                                        │ 2013 │ 3                   │
│ Frank                                                           │ 2014 │ 1                   │
│ Gone Girl                                                       │ 2014 │ 1                   │
│ Grand Budapest Hotel, The                                       │ 2014 │ 2                   │
│ Love & Mercy                                                    │ 2014 │ 1                   │
│ Nightcrawler                                                    │ 2014 │ 1                   │
│ PK                                                              │ 2014 │ 1                   │
│ The Fool                                                        │ 2014 │ 1                   │
│ The Hundred-Foot Journey                                        │ 2014 │ 1                   │
│ The Imitation Game                                              │ 2014 │ 4                   │
│ The Theory of Everything                                        │ 2014 │ 1                   │
│ Whiplash                                                        │ 2014 │ 2                   │
│ Wild Tales                                                      │ 2014 │ 1                   │
│ Big Short, The                                                  │ 2015 │ 3                   │
│ Ex Machina                                                      │ 2015 │ 1                   │
│ Experimenter                                                    │ 2015 │ 1                   │
│ Inside Out                                                      │ 2015 │ 1                   │
│ Straight Outta Compton                                          │ 2015 │ 2                   │
│ The Martian                                                     │ 2015 │ 3                   │
│ The Revenant                                                    │ 2015 │ 1                   │
│ Victor Frankenstein                                             │ 2015 │ 1                   │
│ 13 Hours                                                        │ 2016 │ 1                   │
│ Hacksaw Ridge                                                   │ 2016 │ 1                   │
│ Lion                                                            │ 2016 │ 1                   │
│ Sherlock: The Abominable Bride                                  │ 2016 │ 2                   │
│ Snowden                                                         │ 2016 │ 2                   │
│ Your Name.                                                      │ 2016 │ 1                   │
│ Loving Vincent                                                  │ 2017 │ 1                   │
│ Rough Night                                                     │ 2017 │ 1                   │
│ Three Billboards Outside Ebbing, Missouri                       │ 2017 │ 1                   │
└─────────────────────────────────────────────────────────────────┴──────┴─────────────────────┘
 
7. Провести анализ востребованности ресурса - вывести количество пользователей, регистрировавшихся на сайте в каждом году. Найти, в каких годах регистрировалось больше всего и меньше всего пользователей.
--------------------------------------------------
SELECT strftime('%Y', datetime(register_date, 'unixepoch')) AS reg_year, COUNT(*) AS user_count FROM users GROUP BY reg_year ORDER BY reg_year;
┌──────────┬────────────┐
│ reg_year │ user_count │
├──────────┼────────────┤
│          │ 943        │
└──────────┴────────────┘
SELECT strftime('%Y', datetime(register_date, 'unixepoch')) AS reg_year, COUNT(*) AS user_count FROM users GROUP BY reg_year ORDER BY user_count DESC LIMIT 1;
┌──────────┬────────────┐
│ reg_year │ user_count │
├──────────┼────────────┤
│          │ 943        │
└──────────┴────────────┘
SELECT strftime('%Y', datetime(register_date, 'unixepoch')) AS reg_year, COUNT(*) AS user_count FROM users GROUP BY reg_year ORDER BY user_count ASC LIMIT 1;
┌──────────┬────────────┐
│ reg_year │ user_count │
├──────────┼────────────┤
│          │ 943        │
└──────────┴────────────┘
--------------------------------------------------
Total ok: 3
Total error: 0
--------------------------------------------------
/home/andrey/labs/DB/304_DB_Kurmakaev_RA
Task03
Task from branch: Task03
Creation date: 10/23/2025 15:41:59
To github.com-mrsu:andpop-mrsu/304_DB_Kurmakaev_RA.git
To github.com-mrsu:andpop-mrsu/304_DB_Kurmakaev_RA.git
   23b442f..2e84d79  master -> master
   23b442f..2e84d79  master -> master
304_DB_Kuvakin_RA
304_DB_Lukovataya_KV
304_DB_Migachev_IP
304_DB_Moiseev_OM
304_DB_Nepyanova_AP
304_DB_Pazuhina_AK
304_DB_Piganov_DM
304_DB_Savin_RV
304_DB_Sergeeva_OD
304_DB_Shagilov_KD
304_DB_Shevolaev_IV
304_DB_Sveshnikov_IK
304_DB_Tumajkina_DA
304_DB_Yambaev_KN
304_DB_Yastrebcev_DN
304_DB_Zabnenkov_MA
**********************
PowerShell transcript end
End time: 20251024160836
**********************
