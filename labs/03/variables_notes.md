# О переменных в PHP и JavaScript

В разных языках программирования работа с переменными организована по-разному.

## Объявление и инициализация
### PHP
В PHP переменные предварительно не объявляются. Переменная возникает в момент инициализации (присвоения значения):
```PHP
<?php

echo $a; // PHP Notice:  Undefined variable: a
$a = 1;
```

### JavaScript
В обычном (нестрогом) режиме JavaScript переменную можно инициализировать без объявления:
``` JavaScript
a = 1;
console.log(a);  // 1
```
В строгом режиме так делать нельзя.
``` JavaScript
"use strict";
a = 1;
console.log(a);  // ReferenceError: a is not defined
```
Объявляются переменные с помощью `var`, `let` или `const`. Можно объявлять и инициализировать в одном операторе:
``` JavaScript
var a = 1;
console.log(a);  // 1
```
При этом нужно понимать, что фактически это два оператора:
``` JavaScript
var a;
a = 1;
console.log(a);  // 1
```
Объявления переменных с помощью `var` всплывают вверх блока (`let` и `const` не всплывают):
``` JavaScript
console.log(a);  // undefined

if (false) {
    var a = 1;
}

console.log(b);  // ReferenceError: b is not defined  (даже в нестрогом режиме)

if (false) {
    let b = 1;
}
```

# # #
## Области видимости

## PHP
Переменная может быть определена в **глобальной** области видимости (вне функций).  Например:
```PHP
<?php

$a = 1;
```
Переменная `$a` будет доступна во всем скрипте вне функций, в том числе внутри вкладываемых с помощью `require` и `include` файлoв.
Внутри функций глобальная переменная по умолчанию недоступна! (В этом отличие от JavaScript и C).
```PHP
<?php
$a = 1;

function f()
{
    if (!isset($a)) {
        echo '$a is not set';
    }
}

f();
```
Если внутри функции нужно читать или изменять глобальную переменную, то ее нужно определить внутри функции с ключевым словам `global`:
```PHP
<?php
$a = 1;

function f()
{
    global $a;   // Ссылка на глобальную переменную

    echo $a . PHP_EOL;  // 1

    $a = 2;    // Меняем значение глобальной переменной
}

f();

echo $a . PHP_EOL;   // 2
```
Также можно использовать специальный массив `GLOBALS`:
```PHP
<?php
$a = 1;

function f()
{
    echo $GLOBALS['a'] . PHP_EOL;  // 1

    $GLOBALS['a'] = 2;    // Меняем значение глобальной переменной
}

f();

echo $a . PHP_EOL;   // 2
```

Также переменную можно задать в **локальной** области видимости, то есть внутри определенной функции.
```
<?php
$a = 1;

function f()
{
    $a = 'cat';

    echo $a . PHP_EOL;  // cat
}

f();
```

### JavaScript


В JavaScript областью видимости локальной переменной является вся функция, в том числе та ее часть, которая находится до объявления переменной. Инициализация переменной выполняется только в момент обработки строки, в которой находится эта переменная.
``` JavaScript
var a = 1;

function f() {
    console.log(a); // undefined
    var a = 2;
    console.log(a);
}

f();

function g() {
    console.log(a); // Reference error
    let a = 2;
    console.log(a);
}

f();
```


* * *
## Различные типы областей видимости
В JavaScript используется **лексическая область видимости**, которая определяется статически во время написания кода. 

```
function foo() {
    console.log(a); // 2
}

function bar() {
    var a = 3;
    foo();
}

var a = 2;

bar();
```
При выполнении этого кода в консоль выведется 2, так как в момент определения функции `foo()` значение переменная `a` нашлась в глобальной области видимости.

**Динамическая область видимости** не обращает внимание на то, как и где объявляются функции и области видимости, важно лишь то, *где они вызываются*.
То есть цепочка областей вызовов основана на стеке вызовов, а не на вложенности областей видимостей в коде.
В случае динамической области видимости этот код вывел бы в консоль число 3, так как функция `foo()` вызывается из функции `bar()`, в которой определяется `a=3`.

Итак, лексическая область видимости определяется во время написания кода, а динамическая область видимости определяется во время выполнения (подобным образом ведет себя `this` в JavaScript). Для лексической области видимости важно то, где функция была объявлена, а для динамической области видимости - где она была вызвана.


