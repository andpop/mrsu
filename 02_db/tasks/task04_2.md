## Лабораторная работа 4. Выборка данных с помощью SQL

### Задание
* Создать базу данных movies_rating.db с помощью SQL-скрипта db_init.sql, подготовленного в л/р 2.
* Составить SQL-запросы для выборки данных из movies_rating.db.


1. Найти все драмы, выпущенные после 2005 года, которые понравились женщинам (оценка не ниже 4.5). Для каждого фильма в этом списке вывести название, год выпуска и количество таких оценок.

2. Провести анализ востребованности ресурса - вывести количество пользователей, регистрировавшихся на сайте в каждом году. Найти, в каких годах регистрировалось больше всего и меньше всего пользователей.

3. Найти все пары пользователей, оценивших один и тот же фильм. Устранить дубликаты, проверить отсутствие пар с самим собой. Для каждой пары должны быть указаны имена пользователей и название фильма, который они ценили.

4. Найти 10 самых старых оценок от разных пользователей, вывести названия фильмов, имена пользователей, оценку, дату отзыва в формате ГГГГ-ММ-ДД.

5. Вывести в одном списке все фильмы с максимальным средним рейтингом и все фильмы с минимальным средним рейтингом. Общий список отсортировать по году выпуска и названию фильма. В зависимости от рейтинга в колонке "Рекомендуем" для фильмов должно быть написано "Да" или "Нет".

6. Вычислить количество оценок и среднюю оценку, которую дали фильмам пользователи-мужчины в период с 2011 по 2014 год.

7. Составить список фильмов с указанием средней оценки и количества пользователей, которые их оценили. Полученный список отсортировать по году выпуска и названиям фильмов. В списке оставить первые 20 записей.

8. Определить самый распространенный жанр фильма и количество фильмов в этом жанре.

* Создание базы данных movies_rating.db, заполнение её данными, описание каждого задания и выполнение запроса для его решения оформить в виде кроссплатформенного shell-скрипта task4.bat следующего вида:
```
#!/bin/bash
chcp 65001

sqlite3 movies_rating.db < db_init.sql

echo 1. Текст первого задания. Вывести список из 10 пользователей.
echo --------------------------------------------------
sqlite3 movies_rating.db -box -echo "SELECT * FROM users LIMIT 10"
echo " "

echo 2. Вывести список из 5 пользователей.
echo --------------------------------------------------
sqlite3 movies_rating.db -box -echo "SELECT * FROM users LIMIT 5"
```
* Файл task4.bat должен быть в кодировке UTF-8.
* Текст после команды `echo` должен быть заключен в двойные кавычки.
* После добавления файла task4.bat в индекс локального репозитория Git (то есть после выполнения команды `git add ...`) нужно сделать этот файл исполняемым для Linux: `git update-index --chmod=+x task4.bat`.


* * *
### Требования к оформлению и коду
* Работать нужно в ветке Task04 Git-репозитория.
* В каталоге Task04 должны быть два файла: db_init.sql и task4.bat.

* * *

### Отправка задания на проверку
Процедура отправки задания на проверку и манипуляции с репозиториями после проверки описаны в файле [Git_instruction.md](Git_instruction.md).

