## Лабораторная работа 3. Выборка данных SQL-командой SELECT

### Задание
Создать базу данных movies_rating.db с помощью SQL-скрипта db_init.sql, подготовленного в л/р 2.

Вывести список всех самых свежих фильмов. В список должны войти все фильмы данного года выпуска.

Найти все теги, которые пользователи присваивали фэнтези-фильмам. Названия тегов не должны дублироваться.

Найти 10 самых свежих отзывов, вывести названия фильмов, имена пользователей, дату отзывов в формате ГГГГ-ММ-ДД.

Найти 10 самых старых отзывов, вывести названия фильмов, имена пользователей, дату отзывов в формате ГГГГ-ММ-ДД.

Найти всех пользователей, зарегистрировавшихся с 2018 по 2020 год включительно. В списке сначала должны идти женщины, затем мужчины. Списки мужчин и женщин отсортировать по имени.

Составить список фильмов, имеющих оценки. Список фильмов отсортировать по году выпуска и по названиям.

Составить список фильмов, не имеющих оценки. Список фильмов отсортировать по году выпуска и по названиям.

Определить количество всех пользователей-мужчин и найти, какой процент они составляют от общего количества пользователей.

Определить количество всех фильмов, имеющих оценки, и найти, какой процент они составляют от общего количества фильмов в базе данных.

Определить количество всех фильмов, не имеющих оценок, и найти, какой процент они составляют от общего количества фильмов в базе данных.

Вывести список всех пользователей, фамилии которых начинаются на букву 'A'. Полученный список отсортировать по дате регистрации.

Составить список фильмов с указанием их среднего рейтинга. Полученный список отсортировать по году выпуска и названиям фильмов.

Найти пять фильмов с максимальным средним рейтингом и пять фильмов с минимальным средним рейтингом.

Вычислить среднюю оценку, которую дали пользователи-женщины.

Вычислить среднюю оценку, которую дали пользователи-мужчины.

Написать запрос возвращающий информацию о рейтингах в более читаемом формате: имя эксперта, название фильма, год выпуска, оценка и дата оценки в формате ГГГГ-ММ-ДД. Отсортируйте данные по имени эксперта, затем названию фильма и оценке.

Сформировать список всех комедий, отсортированный сначала по году выпуска, затем по названию.

Сформировать список всех триллеров, отсортированный сначала по году выпуска, затем по названию.


Написать запрос, который для каждого пользователя определяет количество оценок, которые он сделал. Полученный список отсортировать по имени пользователя.

Вывести список фильмов с указанием тегов, которые были им присвоены пользователями. Сортировать по году выпуска, затем по названию фильма, затем по тегу.

Провести анализ занятий пользователей. Для каждого рода занятий найти количество пользователей.

Найти все пары пользователей, оценивших один и тот же фильм. Устранить дубликаты, проверить отсутствие пар с самим собой. Для каждой пары должны быть указаны имена пользователей и название фильма, который они ценили.


для автоматического создания таблиц в базе (CREATE TABLE ...)  и загрузки в них данных (INSERT INTO ...)  из исходных текстовых файлов, которые нужно скопировать из каталога dataset. 
* Утилита должна быть кроссплатформенной (запускаться на разных платформах). Предлагаемые языки: Python, PowerShell. 
* База данных должна называться movies_rating.db.
* Таблицы: 
    * *movies*. Поля id (primary key), title, year, genres.
    * *ratings*. Поля id (primary key), user_id, movie_id, rating, timestamp.
    * *tags*. Поля id (primary key), user_id, movie_id, tag, timestamp.
    * *users*. Поля id (primary key), name, email, gender, register_date, occupation.


* * *
### Требования к оформлению и коду
* Работать нужно в ветке Task03 Git-репозитория.
* Все файлы разместить в каталоге Task03.
* В файле README.md описать требования к окружению для корректной работы скрипта db_init.bat (например, на компьютере должны быть установлены Python v.3 и SQLite), после выполнения которого должна создаться заполненная база данных db_init.db.

* * *

### Отправка задания на проверку
Процедура отправки задания на проверку и манипуляции с репозиториями после проверки описаны в файле [Git_instruction.md](Git_instruction.md).

* * *
### Темы для изучения
* Встраиваемая СУБД SQLite.
    * <https://www.sqlite.org/docs.html> Документация на официальном сайте SQLite.
    * J.A. Kreibich "Using SQLite". Издательство O'Reilly, 2010 год.
    * G. Allen, M. Owens "The Definitive Guide to SQLite", second edition. Издательство Apres, 2010 год.
